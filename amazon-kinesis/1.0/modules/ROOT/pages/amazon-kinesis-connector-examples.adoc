= Amazon Kinesis Data Streams Connector Examples - Mule 4

The following examples show how to use real-time dashboards to evaluate events and use log and event data collections to analyze problems.

These examples use variables for some field values. You can either:

* Replace the variables with their values in the code.
* Provide the values for each variable in a properties file and then refer to that file from the connector configuration.

If you donâ€™t know how to use a properties file, see xref:mule-runtime::mule-app-properties-to-configure.adoc[Configuring Property Placeholders].

Before you try the example, access Anypoint Studio (Studio) and verify that the *Mule Palette* view displays entries for Kinesis. If not, follow the instructions in xref:amazon-kinesis-connector-studio.adoc#add-connector-to-project,Add the Connector to Your Project.

== Put Records into a Specific Kinesis Data Stream

This example shows  how to put a record batch into a specified Kinesis data stream. The following screenshot shows the Anypoint Studio app flow for this example:

  PLACE FOR IMAGE OF FLOW

. Create a new Mule project in Studio.
. In the Mule Palette view, search for `http` and select the *Listener* operation.
. Drag the *Listener* operation onto the canvas.
. In the *Listener* configuration, click *+* next to the *Connector configuration* field to add a global element.
. Enter the following values:
+
[%header,cols="30s,70a"]
|===
|Field |Value
|Name |`HTTP_Listener_Configuration`
|Host |`127.0.0.1`
|Port |`8081`
|===
+
. Click *OK*
. Set the *Path* field to `put_record`.

=== Add the Put Record Operation

Add the *Put Record* operation to write a new record to the Kinesis data stream:

. In the *Mule Palette* view, search for `kinesis`.
. Drag the *Put Record* operation onto the canvas, to the right of *Listener*.
. In the *Put Record* configuration, click *+* to add a global element.
. Enter the following values: *Reviewers, what values should be used for this example?*
+
[%header,cols="30s,70a"]
|===
|Field |Value
|Name |
|Kinesis Producer Library | *???*
|Access Key | ${kinesis.accessKey}
|Secret Key | ${kinesis.secretKey}
|Region Endpoint | ${kinesis.regionEndpoint}
|===
+
. Click *OK*.
. Click *Test Connection* to confirm that Mule can connect with the specified server.
. Enter the following values
+
|===
|Stream name |
|Partition key |Partition key
|Data |Content with size up to 1MB
|===
+


For example:

  PLACE FOR IMAGE OF PUT RECORD CONFIG

=== Add a Transform Message Component

Add a Transform Message component to format the data and show how the metadata is rendered for the output of the *Put Record* operation:

. In the Mule Palette view, search for `transform`.
. Drag the *Transform Message* component onto the canvas, to the right of *Put Record*.
. In the *Transform Message* configuration, overlay the brackets in the *Output* section with this XML:
+
[source,dataweave,linenums]
----
%dw 2.0
output application/json
---
payload
----
+
The following screenshot shows the script as it appears in the Output section of Studio:
+
  PLACE FOR IMAGE OF DATAWEAVE SCRIPT

=== Add a Logger Component

Add a Logger component to show the response in the *Mule Console*:

. In the *Mule Palette* view, search for *Logger* and select the *Logger (Core)* component.
. Drag the *Logger (Core)* component onto the Studio canvas, to the right of *Transform Message*.
. Configure the following fields:
+
[%header,cols="30s,70a"]
|===
|Field |Value
|Display Name |Name for the logger, such as `Log Response`
|Message | #[payload]
|Level |INFO (Default)
|===
+
The following screenshot shows the logger configuration as it appears in Studio:
+
  IMAGE OF LOGGER CONFIG
+
. Test the app by sending a PUT request to `http://127.0.0.1:8081/put_record`.

=== See Also

* xref:connectors::introduction/introduction-to-anypoint-connectors.adoc[Introduction to Anypoint Connectors]
* https://help.mulesoft.com[MuleSoft Help Center]
